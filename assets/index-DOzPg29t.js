import{Y as M,_ as p,s as h,q as w,y as k,o as i,b as m,d,F as b,i as L,E,e as n,p as f,Z as B,Q as A,$ as j,t as g,r as q,h as v,w as C,D as $,j as N,O as G,P as D}from"./index-z4f0t7nZ.js";const y=M("game",{state:()=>({game:{start:!0,score:0,maxScore:0,finalScore:10},brick:{width:40,height:15,bgColor:"#fff",total:21,speed:10},figure:{width:16,height:50,left:15,speed:10,bottom:0},enemy:{width:22,height:30,right:-22,speed:1,speedAdd:1,currentLeft:0}}),getters:{getBrick:o=>o.brick},actions:{setBrickSpeed(o){this.brick.speed=loadsh.cloneDeep(o)},setFigureBottom(o){this.figure.bottom=loadsh.cloneDeep(o)},setGameScore(o){this.game.score=o},setGameMaxScore(o){this.game.maxScore=o},setGameStart(o){this.game.start=o},resetAllState(o){Object.assign(o)}},persist:!0}),V={class:"flex absolute bottom-0",id:"floor"},P={class:"flex"},R={class:"flex"},T={__name:"Floor",setup(o){const a=y(),{brick:t,game:s}=h(a);return w(s.value,(u,e)=>{s.value.start?document.getElementById("floor").classList.add("floorMove"):document.getElementById("floor").classList.remove("floorMove")}),k(()=>{document.getElementById("floor").classList.add("floorMove"),document.getElementById("floor").style.animationDuration=t.value.speed+"s"}),(u,e)=>(i(),m("div",V,[d("div",P,[(i(!0),m(b,null,L(n(t).total,c=>(i(),m("div",{class:"brick",style:E({width:n(t).width+"px",height:n(t).height+"px",backgroundColor:n(t).bgColor,order:0}),key:c},null,4))),128))]),d("div",R,[(i(!0),m(b,null,L(n(t).total,c=>(i(),m("div",{class:"brick splice",style:E({width:n(t).width+"px",height:n(t).height+"px",backgroundColor:n(t).bgColor,order:1}),key:c},null,4))),128))])]))}},O=p(T,[["__scopeId","data-v-694f4d0f"]]),W={__name:"Figure",setup(o){const a=f(null),t=f(null),s=f(600),u=f(100),e=y(),{brick:c,figure:r,game:_}=h(e);w(_,l=>{if(!l.start)s.value=600,u.value=100;else{if(l.score===0)return;s.value<=200&&(u.value=10),s.value=s.value-u.value}},{deep:!0});const I=()=>{r.value.bottom+=r.value.speed,document.getElementById("figure").style.bottom=r.value.bottom+"px",a.value=requestAnimationFrame(I)},x=()=>{r.value.bottom-=r.value.speed,document.getElementById("figure").style.bottom=r.value.bottom+"px",t.value=requestAnimationFrame(x),r.value.bottom<=c.value.height&&(cancelAnimationFrame(t.value),t.value=null)},S=l=>{if(l.keyCode===32){if(!_.value.start||a.value||t.value)return;r.value.bottom=c.value.height,a.value=requestAnimationFrame(I),setTimeout(()=>{cancelAnimationFrame(a.value),a.value=null,t.value=requestAnimationFrame(x)},s.value)}};return k(()=>{let l=document.getElementById("figure");l&&(l.style.bottom=c.value.height+"px",document.addEventListener("keydown",S))}),B((l,F)=>{t.value&&cancelAnimationFrame(t.value),a.value&&cancelAnimationFrame(a.value),document.removeEventListener("keydown",S)}),(l,F)=>(i(),m("div",{id:"figure",style:E({width:n(r).width+"px",height:n(r).height+"px",left:n(r).left+"px"})}," 国伟 ",4))}},z=p(W,[["__scopeId","data-v-1ae666e6"]]),H={__name:"Enemy",setup(o){const a=y(),{brick:t,game:s,figure:u,enemy:e}=h(a),c=f(),r=f(null);w(e.value,l=>{l.currentLeft<=31&&l.currentLeft>=-7&&u.value.bottom<=e.value.height+t.value.height&&_()});const _=()=>{cancelAnimationFrame(r.value),r.value=null,e.value.speed=c.value.speed,e.value.right=c.value.right,e.value.currentLeft=document.getElementById("enemy").offsetLeft,document.getElementById("enemy").style.right=e.value.right+"px",s.value.score>s.value.maxScore&&a.setGameMaxScore(s.value.score),a.setGameScore(0),a.setGameStart(!1)},I=()=>{cancelAnimationFrame(r.value),r.value=null,e.value.right=c.value.right,document.getElementById("enemy").style.right=e.value.right+"px",a.setGameScore(s.value.score+=1),e.value.currentLeft=document.getElementById("enemy").offsetLeft,s.value.score===s.value.finalScore?(a.setGameStart(!1),e.value.speed=c.value.speed):(e.value.speed+=e.value.speedAdd,j({title:"过关成功",message:"按空格开始下一关！",type:"success",duration:3e3}))},x=()=>{const l=document.getElementById("map").offsetWidth;e.value.right+=e.value.speed,e.value.currentLeft=l-e.value.right-e.value.width,document.getElementById("enemy").style.right=e.value.right+"px",r.value=requestAnimationFrame(x),e.value.right>=l&&e.value.right!==c.value.right&&I()},S=l=>{if(l.keyCode===32){if(!s.value.start||r.value)return;r.value=requestAnimationFrame(x)}};return k(()=>{let l=document.getElementById("enemy");l&&(c.value=A(e.value),l.style.bottom=t.value.height+"px",e.value.currentLeft=document.getElementById("enemy").offsetLeft,document.addEventListener("keydown",S))}),B((l,F)=>{r.value&&cancelAnimationFrame(r.value),document.removeEventListener("keydown",S)}),(l,F)=>(i(),m("div",{class:"enemy",id:"enemy",style:E({width:n(e).width+"px",height:n(e).height+"px",right:n(e).right+"px"})}," 杆 ",4))}},J=p(H,[["__scopeId","data-v-03f1a36f"]]),Q={id:"score"},U={__name:"Score",setup(o){const a=y(),{game:t}=h(a);return(s,u)=>(i(),m("div",Q,[d("p",null,"最高关卡："+g(n(t).maxScore),1),d("p",null,"当前关卡："+g(n(t).score),1)]))}},Y=p(U,[["__scopeId","data-v-95d97407"]]),Z={class:"config"},K={__name:"Config",setup(o){const a=y(),{brick:t,game:s,figure:u,enemy:e}=h(a);return(c,r)=>(i(),m("div",Z,[d("p",null,"游戏属性："+g(n(s)),1),d("p",null,"地砖属性："+g(n(t)),1),d("p",null,"人物属性："+g(n(u)),1),d("p",null,"敌人属性："+g(n(e)),1)]))}},X=p(K,[["__scopeId","data-v-1129540f"]]),ee=o=>(G("data-v-dd5624ca"),o=o(),D(),o),te={key:0,id:"fail",class:"flex flex-col items-center justify-center"},ae=ee(()=>d("p",null,"你被绊倒了，请重新来过。",-1)),oe={__name:"Fail",setup(o){const a=y(),{game:t}=h(a),s=f();k(()=>{s.value=A(t.value)});const u=()=>{a.setGameStart(!0)},e=()=>{a.setGameScore(0),a.setGameMaxScore(0),a.setGameStart(!0)};return(c,r)=>{const _=q("el-button");return n(t).start?N("",!0):(i(),m("div",te,[n(t).score<n(t).finalScore?(i(),m(b,{key:0},[ae,v(_,{class:"mt-4",onClick:u},{default:C(()=>[$("再来一局")]),_:1})],64)):(i(),m(b,{key:1},[d("p",null,"恭喜你，通过全部"+g(n(t).finalScore)+"关！",1),v(_,{class:"mt-4",onClick:e},{default:C(()=>[$("重新开始")]),_:1})],64))]))}}},se=p(oe,[["__scopeId","data-v-dd5624ca"]]),ne={id:"map"},re={__name:"GameMap",setup(o){return(a,t)=>(i(),m("div",ne,[v(X),v(Y),v(z),v(J),v(O),v(se)]))}},le=p(re,[["__scopeId","data-v-137d7f6e"]]),ce=o=>(G("data-v-810f1b94"),o=o(),D(),o),ue=ce(()=>d("div",{class:"introduce"},[d("p",{class:"mb-4 text-center font-semibold"},"国伟立定跳"),d("p",null,"玩法简介：按空格开始本关（或下一关），通过按空格让“国伟”跳起来跨越栏杆，跨越成功即算过关，共10关。")],-1)),ie={__name:"index",setup(o){const a=y(),{game:t}=h(a),s=f();return k(()=>{s.value=A(t.value)}),B((u,e)=>{a.resetAllState(s.value)}),(u,e)=>(i(),m(b,null,[ue,v(le)],64))}},de=p(ie,[["__scopeId","data-v-810f1b94"]]);export{de as default};
